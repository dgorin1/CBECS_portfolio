# conf/config.yaml
data:
  raw_dir: "data/raw"
  processed_dir: "data/processed"

datasets:
  - year: 2018
    csv_url: "https://www.eia.gov/consumption/commercial/data/2018/xls/cbecs2018_final_public.csv"

target:
  name: "MFBTU"
  log_name: "LOG_MFBTU"
  drop_na: true   # drop rows with missing target before anything else

drops:
  leakage_risks: ["MFEXP","ELBTU","ELCNS","ELEXP","NGBTU","NGCNS","NGEXP",
                  "MFHTBTU","MFCLBTU","MFVNBTU","MFWTBTU","MFLTBTU","MFCKBTU",
                  "MFRFBTU","MFOFBTU","MFPCBTU","MFOTBTU","ELHTBTU","ELCLBTU",
                  "ELVNBTU","ELWTBTU","ELLTBTU","ELCKBTU","ELRFBTU","ELOFBTU",
                  "ELPCBTU","ELOTBTU","NGHTBTU","NGCLBTU","NGWTBTU","NGCKBTU","NGOTBTU"]
  obvious: ["SQFTC","ELEVTR","ESCLTR","PUBID","NOCCAT","WKHRSC","NWKERC",
            "LZHRPC","LOHRPC","LNHRPC"]
  weight_regex: "FINALWT[0-9]{0,3}"   # regex of columns to drop

fillna:
  to_0: ["BASEMNT","NELVTR","NESLTR","DRYCL","RWSEAT","PBSEAT","EDSEAT","FDSEAT",
         "HCBED","RCACP_EL","PKGCP_EL","CHILP_EL","HTPCP_EL","ACWNWP_EL","EVAPP_EL",
         "OTCLP_EL","CHILP_NG","OTCLP_NG","CHILP_FK","OTCLP_FK","CHILP_PR","OTCLP_PR",
         "CHILP_ST","OTCLP_ST","CHWTP_CW","OTCLP_OT","SNACKSF","FASTFDSF","CAFSF",
         "FDPREPSF","XRAYN","RFGRSN","RFGCOMPN","RFGWIN","RFGOPN","RFGCLN","RFGVNN",
         "RFGICN","RFGSTP","PCTERMN","LAPTPN","MLTMON","TABLETN","SERVERN","LGOFFDEVN",
         "SMOFFDEVN","WBOARDSN","RGSTRN","ATMN","LTZHRP","LTOHRP","LTNHRP","BULBP",
         "HALOP","HIDP","LEDP","OTLTP","PKLTN","DAYLTP"]
  to_1: ["RENOV","FACDST","FACDHW","FACDCW","FACELC"]
  to_2: ["VACANT","DRVTHRU"]

recode:
  single_value:
    # map special → replacement (top-code caps etc.)
    NELVTR: {sentinel: 995, replace: 30}
    NESLTR: {sentinel: 995, replace: 10}
    BASEMNT: {sentinel: 995, replace: 5}
    FLCEILHT: {sentinel: 995, replace: 50}
    RWSEAT: {sentinel: 99995, replace: 2000}
    PBSEAT: {sentinel: 99995, replace: 15000}
    HCBED: {sentinel: 9995, replace: 250}
  # multi-coded special values that need featureization
  nfloor:
    mid_code: 994
    top_code: 995
    mid_replace: 12
    top_replace: 15
    add_bins: true   # add NFLOOR_10_14_BIN & NFLOOR_TOP_BIN

one_off_fixes:
  # DRVTHRU: code 5 (“don’t know”) → 2 (“no”)
  recode_equal:
    DRVTHRU: {5: 2}

impute_median_with_flag: ["OCCUPYP"]   # median-impute + add *_IMPUTED flag

domain_rules:
  # HCBED applicable only for hospital/nursing PBA ∈ {16,17}
  hcbeds:
    col: "HCBED"
    pba_col: "PBA"
    applicable_values: [16, 17]

engineer:
  seats:
    cols: ["RWSEAT","PBSEAT","EDSEAT","FDSEAT"]
    keep_top_flags: ["RWSEAT_TOPCODED","PBSEAT_TOPCODED"]
    out_total: "SEATS_TOTAL"
    out_top_any: "SEATS_TOPCODED"

post:
  # optional: after all rules, drop columns over missing threshold
  drop_missing_threshold: 0.9   # 0.9 means keep columns with >=10% non-null